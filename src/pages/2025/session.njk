---js
{
  pagination: {
    data: "events2025Array",
    size: 1,
    alias: "eventData",
    resolve: "values",
    before: function(paginationData) {
      // Get the nullEDGE event and flatten its sessions
      const nullEDGE = paginationData.find(event => event.id === "2025-nulledge");
      if (!nullEDGE || !nullEDGE.sessions) return [];
      return nullEDGE.sessions.filter(session => session.id !== null);
    }
  },
  layout: "base",
  eleventyComputed: {
    title: (data) => `${data.eventData.title} - nullEDGE 2025`,
    description: (data) => `Watch ${data.eventData.title} from nullEDGE 2025 featuring ${data.eventData.speakers.join(', ')}`,
    permalink: (data) => {
      const slug = data.slugifyTitle(data.eventData.title);
      return `/2025/conference/${slug}/`;
    },
    session: (data) => data.eventData,
    event: (data) => {
      // Find the nullEDGE event from events2025Array
      return data.events2025Array.find(e => e.id === "2025-nulledge");
    }
  }
}
---

{# Import partials #}
{% from "partials/chat.njk" import chatDisplay %}

<div class="container wrapper flow">
  {# Session Header #}
  <header class="session-header flow">
    <nav class="breadcrumb">
      <a href="/">Home</a>
      <span>/</span>
      <a href="/2025/conference">nullEDGE 2025</a>
      <span>/</span>
      <span>{{ eventData.title }}</span>
    </nav>
    
    <h1>{{ eventData.title }}</h1>
    
    <div class="session-meta">
      <div class="meta-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
        </svg>
        <span>{{ eventData.speakers | join(", ") }}</span>
      </div>
      
      <div class="meta-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12 6 12 12 16 14"/>
        </svg>
        <span>{{ eventData.duration }} minutes</span>
      </div>
      
      <div class="meta-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
          <line x1="16" y1="2" x2="16" y2="6"/>
          <line x1="8" y1="2" x2="8" y2="6"/>
          <line x1="3" y1="10" x2="21" y2="10"/>
        </svg>
        <span>{{ eventData.published | formatDate('MMMM D, YYYY') }}</span>
      </div>
    </div>
  </header>

  {# Video Player #}
  <section class="video-section">
    <div class="video-container">
      <iframe 
        src="https://www.youtube.com/embed/{{ eventData.id }}" 
        title="{{ eventData.title }}"
        frameborder="0" 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
        allowfullscreen
        loading="lazy"
      ></iframe>
    </div>
    
    <div class="video-actions">
      <a href="https://www.youtube.com/watch?v={{ eventData.id }}" 
         target="_blank" 
         rel="noopener noreferrer" 
         class="button">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"/>
          <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/>
        </svg>
        Watch on YouTube
      </a>
    </div>
  </section>

  {# Chat Transcript #}
  {{ chatDisplay(eventData.chatMessages) }}

  {# Back to Conference #}
  <section class="back-navigation">
    <a href="/2025/conference" class="button button-secondary">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"/>
        <polyline points="12 19 5 12 12 5"/>
      </svg>
      Back to Conference Schedule
    </a>
  </section>
</div>

<style>
  .session-header {
    text-align: center;
    padding: var(--space-l) 0;
  }

  .breadcrumb {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    font-size: var(--size-step--1);
    color: var(--color-text-muted);
    justify-content: center;
    margin-bottom: var(--space-m);
  }

  .breadcrumb a {
    color: var(--color-primary);
    text-decoration: none;
  }

  .breadcrumb a:hover {
    text-decoration: underline;
  }

  .breadcrumb span {
    color: var(--color-text-muted);
  }

  .session-header h1 {
    margin: 0 0 var(--space-m) 0;
    font-size: var(--size-step-3);
  }

  .session-meta {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-m);
    justify-content: center;
    align-items: center;
  }

  .meta-item {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    font-size: var(--size-step-0);
    color: var(--color-text);
  }

  .meta-item svg {
    color: var(--color-primary);
    flex-shrink: 0;
  }

  .video-section {
    margin: var(--space-xl) 0;
  }

  .video-container {
    aspect-ratio: 16 / 9;
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    background: #000;
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
  }

  .video-container iframe {
    width: 100%;
    height: 100%;
    display: block;
  }

  .video-actions {
    display: flex;
    justify-content: center;
    margin-top: var(--space-m);
  }

  .video-actions .button {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
  }

  .chat-section {
    margin: var(--space-xl) 0;
    padding: var(--space-l);
    background: var(--color-bg-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
  }

  .chat-section h2 {
    margin: 0 0 var(--space-xs) 0;
  }

  .text-muted {
    color: var(--color-text-muted);
    font-size: var(--size-step--1);
  }

  .back-navigation {
    margin: var(--space-xl) 0;
    text-align: center;
  }

  .back-navigation .button {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
  }

  @media (max-width: 768px) {
    .session-header h1 {
      font-size: var(--size-step-2);
    }

    .session-meta {
      flex-direction: column;
      gap: var(--space-s);
    }
  }
</style>
